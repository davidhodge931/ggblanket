---
title: "Functions demo (dark_mode)"
author: "David Hodge"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.width = 6,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 300)
```

## Overview

This article will demonstrate each wrapper function.

```{r setup}
library(ggblanket)
library(ggplot2)
library(dplyr)
library(stringr)
library(tidyr)

theme_set(dark_mode_rt())
```

### gg_area

```{r }
economics |>
  gg_area(
    x = date,
    y = unemploy,
    y_title = "Unemployment", 
  )
```

### gg_bar

```{r }
palmerpenguins::penguins |>
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_bar(
    y = species,
    col = sex,
    width = 0.75,
    position = position_dodge(preserve = "single"),
  )
```

### gg_bin_2d

```{r}
diamonds |>
  gg_bin_2d(
    x = carat,
    y = price,
    col_pal = viridis::mako(9),
  )
```

### gg_blank

```{r}
palmerpenguins::penguins |>
  gg_blank(
    x = flipper_length_mm,
    y = body_mass_g,
    col = sex,
    facet = species,
    y_expand_limits = 0,
  )
```

### gg_boxplot

```{r}
palmerpenguins::penguins |>
  drop_na(sex) |> 
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_boxplot(
    x = body_mass_g,
    y = sex,
    col = sex,
    facet = species,
    theme = dark_mode_b(),
  )
```

### gg_col

```{r}
palmerpenguins::penguins |>
  drop_na(sex) |> 
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  group_by(sex, species) |>
  summarise(across(flipper_length_mm, \(x) mean(x, na.rm = TRUE))) |>
  gg_col(
    x = flipper_length_mm,
    y = species,
    col = sex,
    width = 0.75,
    position = position_dodge(preserve = "single"),
  )
```

### gg_contour

```{r}
faithfuld |>
 gg_contour(
   x = waiting,
   y = eruptions,
   z = density,
   )
```

### gg_contour_filled

```{r}
faithfuld |>
 gg_contour_filled(
   x = waiting,
   y = eruptions,
   z = density,
   bins = 8,
  )
```

### gg_crossbar

```{r}
data.frame(
  trt = factor(c(1, 1, 2, 2)),
  resp = c(1, 5, 3, 4),
  group = factor(c(1, 2, 1, 2)),
  upper = c(1.1, 5.3, 3.3, 4.2),
  lower = c(0.8, 4.6, 2.4, 3.6)) |>
  gg_crossbar(
    x = trt,
    y = resp,
    ymin = lower,
    ymax = upper,
    col = group,
    width = 0.5,
    x_title = "Treatment",
    y_title = "Response",
  )
```

### gg_density

```{r}
palmerpenguins::penguins |>
  drop_na(sex) |> 
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_density(
    x = flipper_length_mm,
    col = species,
    theme = dark_mode_t(),
  )
```

### gg_density_2d

```{r}
faithful |>
  gg_density_2d(
    x = waiting,
    y = eruptions,
    bins = 8,
  )
```

### gg_density_2d_filled

```{r}
faithful |>
  gg_density_2d_filled(
    x = waiting,
    y = eruptions,
    bins = 8,
    col_pal = viridis::mako(8),
  )
```

### gg_errorbar

```{r}
data.frame(
  trt = factor(c(1, 1, 2, 2)),
  resp = c(1, 5, 3, 4),
  group = factor(c(1, 2, 1, 2)),
  upper = c(1.1, 5.3, 3.3, 4.2),
  lower = c(0.8, 4.6, 2.4, 3.6)
) |>
  gg_errorbar(
    x = trt,
    ymin = lower,
    ymax = upper,
    col = group,
    width = 0.1,
    x_title = "Treatment",
    y_title = "Response",
  )
```

### gg_freqpoly

```{r}
palmerpenguins::penguins |>
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_freqpoly(
    x = flipper_length_mm,
    col = sex,
    theme = dark_mode_t(),
    col_title = "",
  )
```

### gg_hex

```{r}
diamonds |>
  gg_hex(
    x = carat,
    y = price,
    y_limits = c(0, 20000),
    coord = coord_cartesian(clip = "on"), 
    col_pal = viridis::mako(9),
  )
```

### gg_histogram

```{r}
palmerpenguins::penguins |>
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_histogram(
    x = flipper_length_mm,
    col = sex,
    facet = species,
    bins = 50,
    theme = dark_mode_b(),
  )
```

### gg_jitter

```{r}
set.seed(123)

palmerpenguins::penguins |>
  gg_jitter(
    x = species,
    y = body_mass_g,
    col = flipper_length_mm,
    col_continuous = "steps",
    y_expand_limits = 0,
    position = position_jitter(height = 0), 
    col_labels = \(x) str_keep_seq(x, by = 2),
    col_pal = viridis::mako(9),
  )
```

### gg_label

```{r}
bind_rows(
  mtcars |> slice_min(order_by = mpg),
  mtcars |> slice_max(order_by = mpg)) |>
  tibble::rownames_to_column("model") |>
  gg_label(
    x = model,
    y = mpg,
    col = mpg,
    label = model,
    size = 3.53,
    y_expand_limits = 0,
    col_pal = c(pal_orange, "white", pal_teal),
    y_title = "Miles per gallon", 
  )
```

### gg_line

```{r}
economics |>
  gg_line(
    x = date,
    y = unemploy,
    y_title = "Unemployment",
    y_expand_limits = 0, 
  )
```

### gg_linerange

```{r}
data.frame(
  trt = factor(c(1, 1, 2, 2)),
  resp = c(1, 5, 3, 4),
  group = factor(c(1, 2, 1, 2)),
  upper = c(1.1, 5.3, 3.3, 4.2),
  lower = c(0.8, 4.6, 2.4, 3.6)) |>
  gg_linerange(
    x = trt,
    ymin = lower,
    ymax = upper,
    col = group,
    position = position_dodge(width = 0.2),
    x_title = "Treatment",
    y_title = "Response",
  )
```

### gg_path

```{r}
economics |>
  mutate(unemploy_rate = unemploy / pop) |>
  gg_path(
    x = unemploy_rate,
    y = psavert,
    x_title = "Unemployment rate",
    y_title = "Personal savings rate",
    y_expand_limits = 0,
  )
```

### gg_point

```{r}
palmerpenguins::penguins |>
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_point(
    x = flipper_length_mm,
    y = body_mass_g, 
    col = sex,
    facet = species, 
    theme = dark_mode_b(),
  )
```

### gg_pointrange

```{r}
data.frame(
  trt = factor(c(1, 1, 2, 2)),
  resp = c(1, 5, 3, 4),
  group = factor(c(1, 2, 1, 2)),
  upper = c(1.1, 5.3, 3.3, 4.2),
  lower = c(0.8, 4.6, 2.4, 3.6)) |>
  gg_pointrange(
    x = trt,
    y = resp,
    col = group,
    ymin = lower,
    ymax = upper,
    position = position_dodge(width = 0.2),
    size = 0.2,
    x_title = "Treatment",
    y_title = "Response",
  )
```

### gg_polygon

```{r}
ids <- factor(c("1.1", "2.1", "1.2", "2.2", "1.3", "2.3"))

values <- data.frame(
  id = ids,
  value = c(3, 3.1, 3.1, 3.2, 3.15, 3.5)
)

positions <- data.frame(
  id = rep(ids, each = 4),
  x = c(2, 1, 1.1, 2.2, 1, 0, 0.3, 1.1, 2.2, 1.1, 1.2, 2.5, 1.1, 0.3,
        0.5, 1.2, 2.5, 1.2, 1.3, 2.7, 1.2, 0.5, 0.6, 1.3),
  y = c(-0.5, 0, 1, 0.5, 0, 0.5, 1.5, 1, 0.5, 1, 2.1, 1.7, 1, 1.5,
        2.2, 2.1, 1.7, 2.1, 3.2, 2.8, 2.1, 2.2, 3.3, 3.2)
)

datapoly <- merge(values, positions, by = c("id"))

datapoly |>
  gg_polygon(
    x = x,
    y = y,
    col = value,
    group = id, 
  )
```

### gg_qq

```{r}
palmerpenguins::penguins |>
  gg_qq(
    sample = body_mass_g,
    facet = species,
    coord = coord_cartesian(clip = "on"), 
  ) +
  geom_qq_line(colour = pal_blue)
```

### gg_raster

```{r}
faithfuld |>
  gg_raster(
    x = waiting,
    y = eruptions,
    col = density,
    col_pal = viridis::mako(9),
  )
```

### gg_rect

```{r}
data.frame(
  x = rep(c(2, 5, 7, 9, 12), 2),
  y = rep(c(1, 2), each = 5),
  z = factor(c(rep(1:3, each = 3), 4)),
  w = rep(diff(c(0, 4, 6, 8, 10, 14)), 2)) |>
  mutate(
    xmin = x - w / 2,
    xmax = x + w / 2,
    ymin = y,
    ymax = y + 1
  ) |>
  gg_rect(
    xmin = xmin,
    xmax = xmax,
    ymin = ymin,
    ymax = ymax,
    col = z,
  )
```

### gg_ribbon

```{r}
data.frame(year = 1875:1972, level = as.vector(LakeHuron)) |>
  mutate(level_min = level - 1, level_max = level + 1) |>
  gg_ribbon(
    x = year,
    ymin = level_min,
    ymax = level_max,
    col_pal = scales::alpha(pal_blue, 0),
    y_title = "Level",
  ) +
  geom_line(aes(x = year, y = level), col = pal_blue)
```

### gg_segment

```{r}
data.frame(x1 = 2.62, x2 = 3.57, y1 = 21.0, y2 = 15.0) |>
  gg_segment(
    x = x1,
    xend = x2,
    y = y1,
    yend = y2,
  )
```

### gg_sf

```{r}
sf::st_read(system.file("shape/nc.shp", package = "sf")) |> 
  gg_sf(
    col = AREA, 
    col_pal = viridis::mako(9),
  )
```

### gg_smooth

```{r}
palmerpenguins::penguins |>
  drop_na(sex) |> 
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_smooth(
    x = flipper_length_mm,
    y = body_mass_g,
    col = sex,
    se = TRUE,
  )
```

### gg_step

```{r}
economics |>
  gg_step(
    x = date,
    y = unemploy,
    y_title = "Unemployment",
    x_limits = c(lubridate::ymd("2010-01-01"), lubridate::NA_Date_), 
    y_expand_limits = 0,
    coord = coord_cartesian(clip = "on"),
  )
```

### gg_text

```{r}
bind_rows(
  mtcars |> slice_min(order_by = mpg),
  mtcars |> slice_max(order_by = mpg)) |>
  tibble::rownames_to_column("model") |>
  gg_text(
    x = model,
    y = mpg,
    col = mpg,
    label = model,
    size = 3.53,
    y_expand_limits = 0,
    col_pal = c(pal_orange, "white", pal_teal),
    y_title = "Miles per gallon",
  )
```

### gg_tile

```{r}
palmerpenguins::penguins |>
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  group_by(species, sex) |>
  summarise(flipper_length_mm = mean(flipper_length_mm, na.rm = TRUE)) |>
  gg_tile(
    x = sex,
    y = species,
    col = flipper_length_mm,
    col_pal = viridis::mako(9),
  )
```

### gg_violin

```{r}
palmerpenguins::penguins |>
  drop_na(sex) |> 
  mutate(across(sex, \(x) str_to_sentence(x))) |> 
  gg_violin(
    x = sex,
    y = body_mass_g,
    col = sex,
    facet = species, 
    theme = dark_mode_b(),
  )
```

### ggblanket

```{r}
palmerpenguins::penguins |>
  drop_na(sex) |>
  mutate(across(sex, \(x) str_to_sentence(x))) |>
  gg_blanket(
    geom = "violin",
    stat = "ydensity",
    position = "dodge",
    x = sex,
    y = body_mass_g,
    col = sex,
    facet = species,
    theme = dark_mode_b(),
  )
```
